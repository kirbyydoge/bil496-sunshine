function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(){var e=function(t){var r=new e.Builder;r.pipeline.add(e.trimmer,e.stopWordFilter,e.stemmer);r.searchPipeline.add(e.stemmer);t.call(r,r);return r.build()};e.version="2.3.9";e.utils={};e.utils.warn=function(e){return function(t){if(e.console&&console.warn){console.warn(t)}}}(this);e.utils.asString=function(e){if(void 0===e||null===e){return""}else{return e.toString()}};e.utils.clone=function(e){if(null===e||e===void 0){return e}for(var t=Object.create(null),r=Object.keys(e),n=0;n<r.length;n++){var s=r[n],d=e[s];if(Array.isArray(d)){t[s]=d.slice();continue}if("string"==typeof d||"number"==typeof d||"boolean"==typeof d){t[s]=d;continue}throw new TypeError("clone is not deep and does not support nested objects")}return t};e.FieldRef=function(e,t,r){this.docRef=e;this.fieldName=t;this._stringValue=r};e.FieldRef.joiner="/";e.FieldRef.fromString=function(t){var r=t.indexOf(e.FieldRef.joiner);if(-1===r){throw"malformed field ref string"}var i=t.slice(0,r),n=t.slice(r+1);return new e.FieldRef(n,i,t)};e.FieldRef.prototype.toString=function(){if(this._stringValue==void 0){this._stringValue=this.fieldName+e.FieldRef.joiner+this.docRef}return this._stringValue};e.Set=function(e){this.elements=Object.create(null);if(e){this.length=e.length;for(var t=0;t<this.length;t++){this.elements[e[t]]=!0}}else{this.length=0}};e.Set.complete={intersect:function intersect(e){return e},union:function union(){return this},contains:function contains(){return!0}};e.Set.empty={intersect:function intersect(){return this},union:function union(e){return e},contains:function contains(){return!1}};e.Set.prototype.contains=function(e){return!!this.elements[e]};e.Set.prototype.intersect=function(t){var r,n,s,d=[];if(t===e.Set.complete){return this}if(t===e.Set.empty){return t}if(this.length<t.length){r=this;n=t}else{r=t;n=this}s=Object.keys(r.elements);for(var o=0,l;o<s.length;o++){l=s[o];if(l in n.elements){d.push(l)}}return new e.Set(d)};e.Set.prototype.union=function(t){if(t===e.Set.complete){return e.Set.complete}if(t===e.Set.empty){return this}return new e.Set(Object.keys(this.elements).concat(Object.keys(t.elements)))};e.idf=function(e,t){var r=0;for(var i in e){if("_index"==i)continue;r+=Object.keys(e[i]).length}var n=(t-r+.5)/(r+.5);return Math.log(1+Math.abs(n))};e.Token=function(e,t){this.str=e||"";this.metadata=t||{}};e.Token.prototype.toString=function(){return this.str};e.Token.prototype.update=function(e){this.str=e(this.str,this.metadata);return this};e.Token.prototype.clone=function(t){t=t||function(e){return e};return new e.Token(t(this.str,this.metadata),this.metadata)};e.tokenizer=function(t,r){if(null==t||t==void 0){return[]}if(Array.isArray(t)){return t.map(function(i){return new e.Token(e.utils.asString(i).toLowerCase(),e.utils.clone(r))})}for(var i=t.toString().toLowerCase(),n=i.length,s=[],d=0,o=0;d<=n;d++){var a=i.charAt(d),l=d-o;if(a.match(e.tokenizer.separator)||d==n){if(0<l){var u=e.utils.clone(r)||{};u.position=[o,l];u.index=s.length;s.push(new e.Token(i.slice(o,d),u))}o=d+1}}return s};e.tokenizer.separator=/[\s\-]+/;e.Pipeline=function(){this._stack=[]};e.Pipeline.registeredFunctions=Object.create(null);e.Pipeline.registerFunction=function(t,r){if(r in this.registeredFunctions){e.utils.warn("Overwriting existing registered function: "+r)}t.label=r;e.Pipeline.registeredFunctions[t.label]=t};e.Pipeline.warnIfFunctionNotRegistered=function(t){var r=t.label&&t.label in this.registeredFunctions;if(!r){e.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",t)}};e.Pipeline.load=function(t){var r=new e.Pipeline;t.forEach(function(t){var i=e.Pipeline.registeredFunctions[t];if(i){r.add(i)}else{throw new Error("Cannot load unregistered function: "+t)}});return r};e.Pipeline.prototype.add=function(){var t=Array.prototype.slice.call(arguments);t.forEach(function(t){e.Pipeline.warnIfFunctionNotRegistered(t);this._stack.push(t)},this)};e.Pipeline.prototype.after=function(t,r){e.Pipeline.warnIfFunctionNotRegistered(r);var i=this._stack.indexOf(t);if(-1==i){throw new Error("Cannot find existingFn")}i=i+1;this._stack.splice(i,0,r)};e.Pipeline.prototype.before=function(t,r){e.Pipeline.warnIfFunctionNotRegistered(r);var i=this._stack.indexOf(t);if(-1==i){throw new Error("Cannot find existingFn")}this._stack.splice(i,0,r)};e.Pipeline.prototype.remove=function(e){var t=this._stack.indexOf(e);if(-1==t){return}this._stack.splice(t,1)};e.Pipeline.prototype.run=function(e){for(var t=this._stack.length,r=0;r<t;r++){for(var n=this._stack[r],s=[],d=0,o;d<e.length;d++){o=n(e[d],d,e);if(null===o||void 0===o||""===o)continue;if(Array.isArray(o)){for(var a=0;a<o.length;a++){s.push(o[a])}}else{s.push(o)}}e=s}return e};e.Pipeline.prototype.runString=function(t,r){var i=new e.Token(t,r);return this.run([i]).map(function(e){return e.toString()})};e.Pipeline.prototype.reset=function(){this._stack=[]};e.Pipeline.prototype.toJSON=function(){return this._stack.map(function(t){e.Pipeline.warnIfFunctionNotRegistered(t);return t.label})};e.Vector=function(e){this._magnitude=0;this.elements=e||[]};e.Vector.prototype.positionForIndex=function(e){if(0==this.elements.length){return 0}var t=0,r=this.elements.length/2,i=r-t,n=Math.floor(i/2),s=this.elements[2*n];while(1<i){if(s<e){t=n}if(s>e){r=n}if(s==e){break}i=r-t;n=t+Math.floor(i/2);s=this.elements[2*n]}if(s==e){return 2*n}if(s>e){return 2*n}if(s<e){return 2*(n+1)}};e.Vector.prototype.insert=function(e,t){this.upsert(e,t,function(){throw"duplicate index"})};e.Vector.prototype.upsert=function(e,t,r){this._magnitude=0;var i=this.positionForIndex(e);if(this.elements[i]==e){this.elements[i+1]=r(this.elements[i+1],t)}else{this.elements.splice(i,0,e,t)}};e.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var e=0,t=this.elements.length,r=1,n;r<t;r+=2){n=this.elements[r];e+=n*n}return this._magnitude=Math.sqrt(e)};e.Vector.prototype.dot=function(e){var t=0,r=this.elements,n=e.elements,s=r.length,d=n.length,o=0,a=0,l=0,u=0;while(l<s&&u<d){o=r[l],a=n[u];if(o<a){l+=2}else if(o>a){u+=2}else if(o==a){t+=r[l+1]*n[u+1];l+=2;u+=2}}return t};e.Vector.prototype.similarity=function(e){return this.dot(e)/this.magnitude()||0};e.Vector.prototype.toArray=function(){for(var e=Array(this.elements.length/2),t=1,r=0;t<this.elements.length;t+=2,r++){e[r]=this.elements[t]}return e};e.Vector.prototype.toJSON=function(){return this.elements};e.stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},r=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,i=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,n=/.$/,s=function(s){var d,o,a,l,u,p,c;if(3>s.length){return s}a=s.substr(0,1);if("y"==a){s=a.toUpperCase()+s.substr(1)}l=/^(.+?)(ss|i)es$/;u=/^(.+?)([^s])s$/;if(l.test(s)){s=s.replace(l,"$1$2")}else if(u.test(s)){s=s.replace(u,"$1$2")}l=/^(.+?)eed$/;u=/^(.+?)(ed|ing)$/;if(l.test(s)){var m=l.exec(s);l=r;if(l.test(m[1])){l=n;s=s.replace(l,"")}}else if(u.test(s)){var m=u.exec(s);d=m[1];u=/^([^aeiou][^aeiouy]*)?[aeiouy]/;if(u.test(d)){s=d;u=/(at|bl|iz)$/;p=/([^aeiouylsz])\1$/;c=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/;if(u.test(s)){s=s+"e"}else if(p.test(s)){l=n;s=s.replace(l,"")}else if(c.test(s)){s=s+"e"}}}l=/^(.+?[^aeiou])y$/;if(l.test(s)){var m=l.exec(s);d=m[1];s=d+"i"}l=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;if(l.test(s)){var m=l.exec(s);d=m[1];o=m[2];l=r;if(l.test(d)){s=d+e[o]}}l=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;if(l.test(s)){var m=l.exec(s);d=m[1];o=m[2];l=r;if(l.test(d)){s=d+t[o]}}l=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;u=/^(.+?)(s|t)(ion)$/;if(l.test(s)){var m=l.exec(s);d=m[1];l=i;if(l.test(d)){s=d}}else if(u.test(s)){var m=u.exec(s);d=m[1]+m[2];u=i;if(u.test(d)){s=d}}l=/^(.+?)e$/;if(l.test(s)){var m=l.exec(s);d=m[1];l=i;u=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/;p=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/;if(l.test(d)||u.test(d)&&!p.test(d)){s=d}}l=/ll$/;u=i;if(l.test(s)&&u.test(s)){l=n;s=s.replace(l,"")}if("y"==a){s=a.toLowerCase()+s.substr(1)}return s};return function(e){return e.update(s)}}();e.Pipeline.registerFunction(e.stemmer,"stemmer");e.generateStopWordFilter=function(e){var t=e.reduce(function(e,t){e[t]=t;return e},{});return function(e){if(e&&t[e.toString()]!==e.toString())return e}};e.stopWordFilter=e.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]);e.Pipeline.registerFunction(e.stopWordFilter,"stopWordFilter");e.trimmer=function(e){return e.update(function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"")})};e.Pipeline.registerFunction(e.trimmer,"trimmer");e.TokenSet=function(){this.final=!1;this.edges={};this.id=e.TokenSet._nextId;e.TokenSet._nextId+=1};e.TokenSet._nextId=1;e.TokenSet.fromArray=function(t){for(var r=new e.TokenSet.Builder,n=0,s=t.length;n<s;n++){r.insert(t[n])}r.finish();return r.root};e.TokenSet.fromClause=function(t){if("editDistance"in t){return e.TokenSet.fromFuzzyString(t.term,t.editDistance)}else{return e.TokenSet.fromString(t.term)}};e.TokenSet.fromFuzzyString=function(t,r){var i=new e.TokenSet,n=[{node:i,editsRemaining:r,str:t}];while(n.length){var s=n.pop();if(0<s.str.length){var d=s.str.charAt(0),o;if(d in s.node.edges){o=s.node.edges[d]}else{o=new e.TokenSet;s.node.edges[d]=o}if(1==s.str.length){o.final=!0}n.push({node:o,editsRemaining:s.editsRemaining,str:s.str.slice(1)})}if(0==s.editsRemaining){continue}if("*"in s.node.edges){var a=s.node.edges["*"]}else{var a=new e.TokenSet;s.node.edges["*"]=a}if(0==s.str.length){a.final=!0}n.push({node:a,editsRemaining:s.editsRemaining-1,str:s.str});if(1<s.str.length){n.push({node:s.node,editsRemaining:s.editsRemaining-1,str:s.str.slice(1)})}if(1==s.str.length){s.node.final=!0}if(1<=s.str.length){if("*"in s.node.edges){var l=s.node.edges["*"]}else{var l=new e.TokenSet;s.node.edges["*"]=l}if(1==s.str.length){l.final=!0}n.push({node:l,editsRemaining:s.editsRemaining-1,str:s.str.slice(1)})}if(1<s.str.length){var u=s.str.charAt(0),p=s.str.charAt(1),c;if(p in s.node.edges){c=s.node.edges[p]}else{c=new e.TokenSet;s.node.edges[p]=c}if(1==s.str.length){c.final=!0}n.push({node:c,editsRemaining:s.editsRemaining-1,str:u+s.str.slice(2)})}}return i};e.TokenSet.fromString=function(t){for(var r=new e.TokenSet,n=r,s=0,d=t.length;s<d;s++){var o=t[s],a=s==d-1;if("*"==o){r.edges[o]=r;r.final=a}else{var l=new e.TokenSet;l.final=a;r.edges[o]=l;r=l}}return n};e.TokenSet.prototype.toArray=function(){var e=[],t=[{prefix:"",node:this}];while(t.length){var r=t.pop(),n=Object.keys(r.node.edges),s=n.length;if(r.node.final){r.prefix.charAt(0);e.push(r.prefix)}for(var d=0,o;d<s;d++){o=n[d];t.push({prefix:r.prefix.concat(o),node:r.node.edges[o]})}}return e};e.TokenSet.prototype.toString=function(){if(this._str){return this._str}for(var e=this.final?"1":"0",t=Object.keys(this.edges).sort(),r=t.length,n=0;n<r;n++){var s=t[n],d=this.edges[s];e=e+s+d.id}return e};e.TokenSet.prototype.intersect=function(t){var r=new e.TokenSet,i=void 0,s=[{qNode:t,output:r,node:this}];while(s.length){i=s.pop();for(var d=Object.keys(i.qNode.edges),o=d.length,a=Object.keys(i.node.edges),l=a.length,u=0,p;u<o;u++){p=d[u];for(var c=0,m;c<l;c++){m=a[c];if(m==p||"*"==p){var y=i.node.edges[m],f=i.qNode.edges[p],h=y.final&&f.final,g=void 0;if(m in i.output.edges){g=i.output.edges[m];g.final=g.final||h}else{g=new e.TokenSet;g.final=h;i.output.edges[m]=g}s.push({qNode:f,output:g,node:y})}}}}return r};e.TokenSet.Builder=function(){this.previousWord="";this.root=new e.TokenSet;this.uncheckedNodes=[];this.minimizedNodes={}};e.TokenSet.Builder.prototype.insert=function(t){var r,n=0;if(t<this.previousWord){throw new Error("Out of order word insertion")}for(var s=0;s<t.length&&s<this.previousWord.length;s++){if(t[s]!=this.previousWord[s])break;n++}this.minimize(n);if(0==this.uncheckedNodes.length){r=this.root}else{r=this.uncheckedNodes[this.uncheckedNodes.length-1].child}for(var s=n;s<t.length;s++){var d=new e.TokenSet,o=t[s];r.edges[o]=d;this.uncheckedNodes.push({parent:r,char:o,child:d});r=d}r.final=!0;this.previousWord=t};e.TokenSet.Builder.prototype.finish=function(){this.minimize(0)};e.TokenSet.Builder.prototype.minimize=function(e){for(var t=this.uncheckedNodes.length-1;t>=e;t--){var r=this.uncheckedNodes[t],n=r.child.toString();if(n in this.minimizedNodes){r.parent.edges[r.char]=this.minimizedNodes[n]}else{r.child._str=n;this.minimizedNodes[n]=r.child}this.uncheckedNodes.pop()}};e.Index=function(e){this.invertedIndex=e.invertedIndex;this.fieldVectors=e.fieldVectors;this.tokenSet=e.tokenSet;this.fields=e.fields;this.pipeline=e.pipeline};e.Index.prototype.search=function(t){return this.query(function(r){var i=new e.QueryParser(t,r);i.parse()})};e.Index.prototype.query=function(t){for(var r=new e.Query(this.fields),n=Object.create(null),s=Object.create(null),d=Object.create(null),o=Object.create(null),a=Object.create(null),u=0;u<this.fields.length;u++){s[this.fields[u]]=new e.Vector}t.call(r,r);for(var u=0;u<r.clauses.length;u++){var p=r.clauses[u],c=null,y=e.Set.empty;if(p.usePipeline){c=this.pipeline.runString(p.term,{fields:p.fields})}else{c=[p.term]}for(var f=0,h;f<c.length;f++){h=c[f];p.term=h;var g=e.TokenSet.fromClause(p),x=this.tokenSet.intersect(g).toArray();if(0===x.length&&p.presence===e.Query.presence.REQUIRED){for(var Q=0,S;Q<p.fields.length;Q++){S=p.fields[Q];o[S]=e.Set.empty}break}for(var L=0;L<x.length;L++){for(var E=x[L],P=this.invertedIndex[E],T=P._index,Q=0;Q<p.fields.length;Q++){var S=p.fields[Q],R=P[S],I=Object.keys(R),F=E+"/"+S,N=new e.Set(I);if(p.presence==e.Query.presence.REQUIRED){y=y.union(N);if(o[S]===void 0){o[S]=e.Set.complete}}if(p.presence==e.Query.presence.PROHIBITED){if(a[S]===void 0){a[S]=e.Set.empty}a[S]=a[S].union(N);continue}s[S].upsert(T,p.boost,function(e,t){return e+t});if(d[F]){continue}for(var C=0;C<I.length;C++){var _=I[C],w=new e.FieldRef(_,S),b=R[_],D;if((D=n[w])===void 0){n[w]=new e.MatchData(E,S,b)}else{D.add(E,S,b)}}d[F]=!0}}}if(p.presence===e.Query.presence.REQUIRED){for(var Q=0,S;Q<p.fields.length;Q++){S=p.fields[Q];o[S]=o[S].intersect(y)}}}for(var v=e.Set.complete,O=e.Set.empty,u=0,S;u<this.fields.length;u++){S=this.fields[u];if(o[S]){v=v.intersect(o[S])}if(a[S]){O=O.union(a[S])}}var B=Object.keys(n),A=[],V=Object.create(null);if(r.isNegated()){B=Object.keys(this.fieldVectors);for(var u=0;u<B.length;u++){var w=B[u],z=e.FieldRef.fromString(w);n[w]=new e.MatchData}}for(var u=0;u<B.length;u++){var z=e.FieldRef.fromString(B[u]),q=z.docRef;if(!v.contains(q)){continue}if(O.contains(q)){continue}var M=this.fieldVectors[z],W=s[z.fieldName].similarity(M),U;if((U=V[q])!==void 0){U.score+=W;U.matchData.combine(n[z])}else{var K={ref:q,score:W,matchData:n[z]};V[q]=K;A.push(K)}}return A.sort(function(e,t){return t.score-e.score})};e.Index.prototype.toJSON=function(){var t=Object.keys(this.invertedIndex).sort().map(function(e){return[e,this.invertedIndex[e]]},this),r=Object.keys(this.fieldVectors).map(function(e){return[e,this.fieldVectors[e].toJSON()]},this);return{version:e.version,fields:this.fields,fieldVectors:r,invertedIndex:t,pipeline:this.pipeline.toJSON()}};e.Index.load=function(t){var r={},n={},s=t.fieldVectors,d=Object.create(null),o=t.invertedIndex,a=new e.TokenSet.Builder,l=e.Pipeline.load(t.pipeline);if(t.version!=e.version){e.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+e.version+"' does not match serialized index '"+t.version+"'")}for(var u=0;u<s.length;u++){var p=s[u],c=p[0],m=p[1];n[c]=new e.Vector(m)}for(var u=0;u<o.length;u++){var p=o[u],y=p[0],f=p[1];a.insert(y);d[y]=f}a.finish();r.fields=t.fields;r.fieldVectors=n;r.invertedIndex=d;r.tokenSet=a.root;r.pipeline=l;return new e.Index(r)};e.Builder=function(){this._ref="id";this._fields=Object.create(null);this._documents=Object.create(null);this.invertedIndex=Object.create(null);this.fieldTermFrequencies={};this.fieldLengths={};this.tokenizer=e.tokenizer;this.pipeline=new e.Pipeline;this.searchPipeline=new e.Pipeline;this.documentCount=0;this._b=.75;this._k1=1.2;this.termIndex=0;this.metadataWhitelist=[]};e.Builder.prototype.ref=function(e){this._ref=e};e.Builder.prototype.field=function(e,t){if(/\//.test(e)){throw new RangeError("Field '"+e+"' contains illegal character '/'")}this._fields[e]=t||{}};e.Builder.prototype.b=function(e){if(0>e){this._b=0}else if(1<e){this._b=1}else{this._b=e}};e.Builder.prototype.k1=function(e){this._k1=e};e.Builder.prototype.add=function(t,r){var n=t[this._ref],s=Object.keys(this._fields);this._documents[n]=r||{};this.documentCount+=1;for(var d=0;d<s.length;d++){var o=s[d],a=this._fields[o].extractor,u=a?a(t):t[o],p=this.tokenizer(u,{fields:[o]}),c=this.pipeline.run(p),m=new e.FieldRef(n,o),y=Object.create(null);this.fieldTermFrequencies[m]=y;this.fieldLengths[m]=0;this.fieldLengths[m]+=c.length;for(var f=0,h;f<c.length;f++){h=c[f];if(y[h]==void 0){y[h]=0}y[h]+=1;if(this.invertedIndex[h]==void 0){var g=Object.create(null);g._index=this.termIndex;this.termIndex+=1;for(var x=0;x<s.length;x++){g[s[x]]=Object.create(null)}this.invertedIndex[h]=g}if(this.invertedIndex[h][o][n]==void 0){this.invertedIndex[h][o][n]=Object.create(null)}for(var Q=0;Q<this.metadataWhitelist.length;Q++){var S=this.metadataWhitelist[Q],L=h.metadata[S];if(this.invertedIndex[h][o][n][S]==void 0){this.invertedIndex[h][o][n][S]=[]}this.invertedIndex[h][o][n][S].push(L)}}}};e.Builder.prototype.calculateAverageFieldLengths=function(){for(var t=Object.keys(this.fieldLengths),r=t.length,n={},s={},d=0;d<r;d++){var o=e.FieldRef.fromString(t[d]),a=o.fieldName;s[a]||(s[a]=0);s[a]+=1;n[a]||(n[a]=0);n[a]+=this.fieldLengths[o]}for(var l=Object.keys(this._fields),d=0,u;d<l.length;d++){u=l[d];n[u]=n[u]/s[u]}this.averageFieldLength=n};e.Builder.prototype.createFieldVectors=function(){for(var t={},r=Object.keys(this.fieldTermFrequencies),n=r.length,s=Object.create(null),d=0;d<n;d++){for(var o=e.FieldRef.fromString(r[d]),a=o.fieldName,l=this.fieldLengths[o],u=new e.Vector,p=this.fieldTermFrequencies[o],c=Object.keys(p),m=c.length,y=this._fields[a].boost||1,f=this._documents[o.docRef].boost||1,h=0;h<m;h++){var g=c[h],x=p[g],Q=this.invertedIndex[g]._index,k,S,L;if(s[g]===void 0){k=e.idf(this.invertedIndex[g],this.documentCount);s[g]=k}else{k=s[g]}S=k*((this._k1+1)*x)/(this._k1*(1-this._b+this._b*(l/this.averageFieldLength[a]))+x);S*=y;S*=f;L=Math.round(1e3*S)/1e3;u.insert(Q,L)}t[o]=u}this.fieldVectors=t};e.Builder.prototype.createTokenSet=function(){this.tokenSet=e.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())};e.Builder.prototype.build=function(){this.calculateAverageFieldLengths();this.createFieldVectors();this.createTokenSet();return new e.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})};e.Builder.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this);e.apply(this,t)};e.MatchData=function(e,t,r){for(var n=Object.create(null),s=Object.keys(r||{}),d=0,o;d<s.length;d++){o=s[d];n[o]=r[o].slice()}this.metadata=Object.create(null);if(e!==void 0){this.metadata[e]=Object.create(null);this.metadata[e][t]=n}};e.MatchData.prototype.combine=function(e){for(var t=Object.keys(e.metadata),r=0;r<t.length;r++){var n=t[r],s=Object.keys(e.metadata[n]);if(this.metadata[n]==void 0){this.metadata[n]=Object.create(null)}for(var d=0;d<s.length;d++){var o=s[d],a=Object.keys(e.metadata[n][o]);if(this.metadata[n][o]==void 0){this.metadata[n][o]=Object.create(null)}for(var l=0,u;l<a.length;l++){u=a[l];if(this.metadata[n][o][u]==void 0){this.metadata[n][o][u]=e.metadata[n][o][u]}else{this.metadata[n][o][u]=this.metadata[n][o][u].concat(e.metadata[n][o][u])}}}}};e.MatchData.prototype.add=function(e,t,r){if(!(e in this.metadata)){this.metadata[e]=Object.create(null);this.metadata[e][t]=r;return}if(!(t in this.metadata[e])){this.metadata[e][t]=r;return}for(var n=Object.keys(r),s=0,d;s<n.length;s++){d=n[s];if(d in this.metadata[e][t]){this.metadata[e][t][d]=this.metadata[e][t][d].concat(r[d])}else{this.metadata[e][t][d]=r[d]}}};e.Query=function(e){this.clauses=[];this.allFields=e};e.Query.wildcard=new String("*");e.Query.wildcard.NONE=0;e.Query.wildcard.LEADING=1;e.Query.wildcard.TRAILING=2;e.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3};e.Query.prototype.clause=function(t){if(!("fields"in t)){t.fields=this.allFields}if(!("boost"in t)){t.boost=1}if(!("usePipeline"in t)){t.usePipeline=!0}if(!("wildcard"in t)){t.wildcard=e.Query.wildcard.NONE}if(t.wildcard&e.Query.wildcard.LEADING&&t.term.charAt(0)!=e.Query.wildcard){t.term="*"+t.term}if(t.wildcard&e.Query.wildcard.TRAILING&&t.term.slice(-1)!=e.Query.wildcard){t.term=""+t.term+"*"}if(!("presence"in t)){t.presence=e.Query.presence.OPTIONAL}this.clauses.push(t);return this};e.Query.prototype.isNegated=function(){for(var t=0;t<this.clauses.length;t++){if(this.clauses[t].presence!=e.Query.presence.PROHIBITED){return!1}}return!0};e.Query.prototype.term=function(t,r){if(Array.isArray(t)){t.forEach(function(i){this.term(i,e.utils.clone(r))},this);return this}var i=r||{};i.term=t.toString();this.clause(i);return this};e.QueryParseError=function(e,t,r){this.name="QueryParseError";this.message=e;this.start=t;this.end=r};e.QueryParseError.prototype=new Error;e.QueryLexer=function(e){this.lexemes=[];this.str=e;this.length=e.length;this.pos=0;this.start=0;this.escapeCharPositions=[]};e.QueryLexer.prototype.run=function(){var t=e.QueryLexer.lexText;while(t){t=t(this)}};e.QueryLexer.prototype.sliceString=function(){for(var e=[],t=this.start,r=this.pos,n=0;n<this.escapeCharPositions.length;n++){r=this.escapeCharPositions[n];e.push(this.str.slice(t,r));t=r+1}e.push(this.str.slice(t,this.pos));this.escapeCharPositions.length=0;return e.join("")};e.QueryLexer.prototype.emit=function(e){this.lexemes.push({type:e,str:this.sliceString(),start:this.start,end:this.pos});this.start=this.pos};e.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1);this.pos+=1};e.QueryLexer.prototype.next=function(){if(this.pos>=this.length){return e.QueryLexer.EOS}var t=this.str.charAt(this.pos);this.pos+=1;return t};e.QueryLexer.prototype.width=function(){return this.pos-this.start};e.QueryLexer.prototype.ignore=function(){if(this.start==this.pos){this.pos+=1}this.start=this.pos};e.QueryLexer.prototype.backup=function(){this.pos-=1};e.QueryLexer.prototype.acceptDigitRun=function(){var t,r;do{t=this.next();r=t.charCodeAt(0)}while(47<r&&58>r);if(t!=e.QueryLexer.EOS){this.backup()}};e.QueryLexer.prototype.more=function(){return this.pos<this.length};e.QueryLexer.EOS="EOS";e.QueryLexer.FIELD="FIELD";e.QueryLexer.TERM="TERM";e.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE";e.QueryLexer.BOOST="BOOST";e.QueryLexer.PRESENCE="PRESENCE";e.QueryLexer.lexField=function(t){t.backup();t.emit(e.QueryLexer.FIELD);t.ignore();return e.QueryLexer.lexText};e.QueryLexer.lexTerm=function(t){if(1<t.width()){t.backup();t.emit(e.QueryLexer.TERM)}t.ignore();if(t.more()){return e.QueryLexer.lexText}};e.QueryLexer.lexEditDistance=function(t){t.ignore();t.acceptDigitRun();t.emit(e.QueryLexer.EDIT_DISTANCE);return e.QueryLexer.lexText};e.QueryLexer.lexBoost=function(t){t.ignore();t.acceptDigitRun();t.emit(e.QueryLexer.BOOST);return e.QueryLexer.lexText};e.QueryLexer.lexEOS=function(t){if(0<t.width()){t.emit(e.QueryLexer.TERM)}};e.QueryLexer.termSeparator=e.tokenizer.separator;e.QueryLexer.lexText=function(t){while(!0){var r=t.next();if(r==e.QueryLexer.EOS){return e.QueryLexer.lexEOS}if(92==r.charCodeAt(0)){t.escapeCharacter();continue}if(":"==r){return e.QueryLexer.lexField}if("~"==r){t.backup();if(0<t.width()){t.emit(e.QueryLexer.TERM)}return e.QueryLexer.lexEditDistance}if("^"==r){t.backup();if(0<t.width()){t.emit(e.QueryLexer.TERM)}return e.QueryLexer.lexBoost}if("+"==r&&1===t.width()){t.emit(e.QueryLexer.PRESENCE);return e.QueryLexer.lexText}if("-"==r&&1===t.width()){t.emit(e.QueryLexer.PRESENCE);return e.QueryLexer.lexText}if(r.match(e.QueryLexer.termSeparator)){return e.QueryLexer.lexTerm}}};e.QueryParser=function(t,r){this.lexer=new e.QueryLexer(t);this.query=r;this.currentClause={};this.lexemeIdx=0};e.QueryParser.prototype.parse=function(){this.lexer.run();this.lexemes=this.lexer.lexemes;var t=e.QueryParser.parseClause;while(t){t=t(this)}return this.query};e.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]};e.QueryParser.prototype.consumeLexeme=function(){var e=this.peekLexeme();this.lexemeIdx+=1;return e};e.QueryParser.prototype.nextClause=function(){var e=this.currentClause;this.query.clause(e);this.currentClause={}};e.QueryParser.parseClause=function(t){var r=t.peekLexeme();if(r==void 0){return}switch(r.type){case e.QueryLexer.PRESENCE:return e.QueryParser.parsePresence;case e.QueryLexer.FIELD:return e.QueryParser.parseField;case e.QueryLexer.TERM:return e.QueryParser.parseTerm;default:var i="expected either a field or a term, found "+r.type;if(1<=r.str.length){i+=" with value '"+r.str+"'"}throw new e.QueryParseError(i,r.start,r.end);}};e.QueryParser.parsePresence=function(t){var r=t.consumeLexeme();if(r==void 0){return}switch(r.str){case"-":t.currentClause.presence=e.Query.presence.PROHIBITED;break;case"+":t.currentClause.presence=e.Query.presence.REQUIRED;break;default:var i="unrecognised presence operator'"+r.str+"'";throw new e.QueryParseError(i,r.start,r.end);}var n=t.peekLexeme();if(n==void 0){var i="expecting term or field, found nothing";throw new e.QueryParseError(i,r.start,r.end)}switch(n.type){case e.QueryLexer.FIELD:return e.QueryParser.parseField;case e.QueryLexer.TERM:return e.QueryParser.parseTerm;default:var i="expecting term or field, found '"+n.type+"'";throw new e.QueryParseError(i,n.start,n.end);}};e.QueryParser.parseField=function(t){var r=t.consumeLexeme();if(r==void 0){return}if(-1==t.query.allFields.indexOf(r.str)){var i=t.query.allFields.map(function(e){return"'"+e+"'"}).join(", "),n="unrecognised field '"+r.str+"', possible fields: "+i;throw new e.QueryParseError(n,r.start,r.end)}t.currentClause.fields=[r.str];var s=t.peekLexeme();if(s==void 0){var n="expecting term, found nothing";throw new e.QueryParseError(n,r.start,r.end)}switch(s.type){case e.QueryLexer.TERM:return e.QueryParser.parseTerm;default:var n="expecting term, found '"+s.type+"'";throw new e.QueryParseError(n,s.start,s.end);}};e.QueryParser.parseTerm=function(t){var r=t.consumeLexeme();if(r==void 0){return}t.currentClause.term=r.str.toLowerCase();if(-1!=r.str.indexOf("*")){t.currentClause.usePipeline=!1}var i=t.peekLexeme();if(i==void 0){t.nextClause();return}switch(i.type){case e.QueryLexer.TERM:t.nextClause();return e.QueryParser.parseTerm;case e.QueryLexer.FIELD:t.nextClause();return e.QueryParser.parseField;case e.QueryLexer.EDIT_DISTANCE:return e.QueryParser.parseEditDistance;case e.QueryLexer.BOOST:return e.QueryParser.parseBoost;case e.QueryLexer.PRESENCE:t.nextClause();return e.QueryParser.parsePresence;default:var n="Unexpected lexeme type '"+i.type+"'";throw new e.QueryParseError(n,i.start,i.end);}};e.QueryParser.parseEditDistance=function(t){var r=t.consumeLexeme();if(r==void 0){return}var i=parseInt(r.str,10);if(isNaN(i)){var n="edit distance must be numeric";throw new e.QueryParseError(n,r.start,r.end)}t.currentClause.editDistance=i;var s=t.peekLexeme();if(s==void 0){t.nextClause();return}switch(s.type){case e.QueryLexer.TERM:t.nextClause();return e.QueryParser.parseTerm;case e.QueryLexer.FIELD:t.nextClause();return e.QueryParser.parseField;case e.QueryLexer.EDIT_DISTANCE:return e.QueryParser.parseEditDistance;case e.QueryLexer.BOOST:return e.QueryParser.parseBoost;case e.QueryLexer.PRESENCE:t.nextClause();return e.QueryParser.parsePresence;default:var n="Unexpected lexeme type '"+s.type+"'";throw new e.QueryParseError(n,s.start,s.end);}};e.QueryParser.parseBoost=function(t){var r=t.consumeLexeme();if(r==void 0){return}var i=parseInt(r.str,10);if(isNaN(i)){var n="boost must be numeric";throw new e.QueryParseError(n,r.start,r.end)}t.currentClause.boost=i;var s=t.peekLexeme();if(s==void 0){t.nextClause();return}switch(s.type){case e.QueryLexer.TERM:t.nextClause();return e.QueryParser.parseTerm;case e.QueryLexer.FIELD:t.nextClause();return e.QueryParser.parseField;case e.QueryLexer.EDIT_DISTANCE:return e.QueryParser.parseEditDistance;case e.QueryLexer.BOOST:return e.QueryParser.parseBoost;case e.QueryLexer.PRESENCE:t.nextClause();return e.QueryParser.parsePresence;default:var n="Unexpected lexeme type '"+s.type+"'";throw new e.QueryParseError(n,s.start,s.end);}};(function(e,t){if("function"==typeof define&&define.amd){define ("tool_componentlibrary/lunr",t)}else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=t()}else{e.lunr=t()}})(this,function(){return e})})();
//# sourceMappingURL=lunr.min.js.map
