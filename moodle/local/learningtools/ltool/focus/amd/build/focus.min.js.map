{"version":3,"file":"focus.min.js","sources":["../src/focus.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Focus ltool define js.\n * @module   ltool_focus\n * @copyright 2021, bdecent gmbh bdecent.de\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'core/ajax'],\n function($, Ajax) {\n\n    /**\n     * Controls focus tool action.\n     * @param {int} focusMode\n     */\n    var LearningToolFocus = function(focusMode) {\n        var self = this;\n        var focusBlock = document.querySelector('.ltoolfocus-info');\n        var focusInfo = document.querySelector(\".ltoolfocus-info #ltoolfocus-action\");\n        if (focusMode) {\n            self.addFocusMode(focusBlock);\n            if (self.disableButton) {\n                if (self.disableButton.classList.contains('d-none')) {\n                    self.disableButton.classList.remove('d-none');\n                }\n            }\n        }\n\n        if (focusInfo) {\n            focusInfo.addEventListener(\"click\", function() {\n                if (focusBlock) {\n                    if (focusBlock.classList.contains('enable')) {\n                        focusBlock.classList.remove('enable');\n                        self.focusModeAction(0);\n                        self.removeFocusMode();\n                    } else {\n                        focusBlock.classList.add('enable');\n                        self.focusModeAction(1);\n                        self.addFocusMode(focusBlock);\n                    }\n                }\n            });\n\n            // Hover color.\n            var focushovercolor = focusInfo.getAttribute(\"data-hovercolor\");\n            var focusfontcolor = focusInfo.getAttribute(\"data-fontcolor\");\n            if (focushovercolor && focusfontcolor) {\n                focusInfo.addEventListener(\"mouseover\", function() {\n                    document.querySelector('#ltoolfocus-info p').style.background = focushovercolor;\n                    document.querySelector('#ltoolfocus-info p').style.color = focusfontcolor;\n                });\n            }\n        }\n\n        if (self.disableButton) {\n            self.disableButton.addEventListener(\"click\", function() {\n                self.focusModeAction(0);\n                self.removeFocusMode();\n            });\n        }\n    };\n\n    LearningToolFocus.prototype.disableButton = document.querySelector('#page-wrapper #disable-focusmode');\n\n    LearningToolFocus.prototype.addFocusMode = function(element) {\n        var self = this;\n        var focusCssUrl = element.getAttribute('data-focuscssurl');\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\n        if (focusCssLink) {\n            focusCssLink.setAttribute('href', focusCssUrl);\n        }\n        self.loadEnableFocusmode();\n    };\n\n    LearningToolFocus.prototype.removeFocusMode = function() {\n        var self = this;\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\n        if (focusCssLink) {\n            focusCssLink.setAttribute('href', \"\");\n        }\n\n        var focusBlock = document.querySelector('.ltoolfocus-info');\n        if (focusBlock.classList.contains('enable')) {\n            focusBlock.classList.remove('enable');\n        }\n        self.loadDisableFocusmode();\n    };\n\n    LearningToolFocus.prototype.loadDisableFocusmode = function() {\n        var self = this;\n        if (self.disableButton) {\n            if (!self.disableButton.classList.contains('d-none')) {\n                self.disableButton.classList.add('d-none');\n            }\n        }\n    };\n\n    LearningToolFocus.prototype.loadEnableFocusmode = function() {\n        var self = this;\n        // Implemented the focus disable button.\n        var body = document.querySelector(\"body\");\n        if (body) {\n            if (!body.classList.contains('drawer-open-left')) {\n                body.classList.remove('drawer-open-left');\n            }\n        }\n        if (self.disableButton) {\n            self.disableButton.classList.remove('d-none');\n        }\n    };\n\n    LearningToolFocus.prototype.focusModeAction = function(status) {\n        Ajax.call([{\n            methodname: 'ltool_focus_save_userfocusmode',\n            args: {status: status},\n            done: function() {\n                return true;\n            }\n        }]);\n    };\n\n    return {\n        init: function(focusMode) {\n            return new LearningToolFocus(focusMode);\n        }\n    };\n\n });"],"names":["define","$","Ajax","LearningToolFocus","focusMode","self","this","focusBlock","document","querySelector","focusInfo","addFocusMode","disableButton","classList","contains","remove","addEventListener","focusModeAction","removeFocusMode","add","focushovercolor","getAttribute","focusfontcolor","style","background","color","prototype","element","focusCssUrl","focusCssLink","querySelectorAll","setAttribute","loadEnableFocusmode","loadDisableFocusmode","body","status","call","methodname","args","done","init"],"mappings":";;;;;;AAsBCA,2BAAO,CAAC,SAAU,cAClB,SAASC,EAAGC,UAMLC,kBAAoB,SAASC,eACzBC,KAAOC,KACPC,WAAaC,SAASC,cAAc,oBACpCC,UAAYF,SAASC,cAAc,0CACnCL,YACAC,KAAKM,aAAaJ,YACdF,KAAKO,eACDP,KAAKO,cAAcC,UAAUC,SAAS,WACtCT,KAAKO,cAAcC,UAAUE,OAAO,WAK5CL,UAAW,CACXA,UAAUM,iBAAiB,SAAS,WAC5BT,aACIA,WAAWM,UAAUC,SAAS,WAC9BP,WAAWM,UAAUE,OAAO,UAC5BV,KAAKY,gBAAgB,GACrBZ,KAAKa,oBAELX,WAAWM,UAAUM,IAAI,UACzBd,KAAKY,gBAAgB,GACrBZ,KAAKM,aAAaJ,qBAM1Ba,gBAAkBV,UAAUW,aAAa,mBACzCC,eAAiBZ,UAAUW,aAAa,kBACxCD,iBAAmBE,gBACnBZ,UAAUM,iBAAiB,aAAa,WACpCR,SAASC,cAAc,sBAAsBc,MAAMC,WAAaJ,gBAChEZ,SAASC,cAAc,sBAAsBc,MAAME,MAAQH,kBAKnEjB,KAAKO,eACLP,KAAKO,cAAcI,iBAAiB,SAAS,WACzCX,KAAKY,gBAAgB,GACrBZ,KAAKa,6BAKjBf,kBAAkBuB,UAAUd,cAAgBJ,SAASC,cAAc,oCAEnEN,kBAAkBuB,UAAUf,aAAe,SAASgB,aAE5CC,YAAcD,QAAQN,aAAa,oBACnCQ,aAAerB,SAASsB,iBAAiB,oCAAoC,GAC7ED,cACAA,aAAaE,aAAa,OAAQH,aAJ3BtB,KAMN0B,uBAGT7B,kBAAkBuB,UAAUR,gBAAkB,eAEtCW,aAAerB,SAASsB,iBAAiB,oCAAoC,GAC7ED,cACAA,aAAaE,aAAa,OAAQ,QAGlCxB,WAAaC,SAASC,cAAc,oBACpCF,WAAWM,UAAUC,SAAS,WAC9BP,WAAWM,UAAUE,OAAO,UARrBT,KAUN2B,wBAGT9B,kBAAkBuB,UAAUO,qBAAuB,WACpC3B,KACFM,gBADEN,KAEGM,cAAcC,UAAUC,SAAS,WAFpCR,KAGEM,cAAcC,UAAUM,IAAI,YAK7ChB,kBAAkBuB,UAAUM,oBAAsB,eAG1CE,KAAO1B,SAASC,cAAc,QAC9ByB,OACKA,KAAKrB,UAAUC,SAAS,qBACzBoB,KAAKrB,UAAUE,OAAO,qBALnBT,KAQFM,eAREN,KASFM,cAAcC,UAAUE,OAAO,WAI5CZ,kBAAkBuB,UAAUT,gBAAkB,SAASkB,QACnDjC,KAAKkC,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAM,CAACH,OAAQA,QACfI,KAAM,kBACK,OAKZ,CACHC,KAAM,SAASpC,kBACJ,IAAID,kBAAkBC"}