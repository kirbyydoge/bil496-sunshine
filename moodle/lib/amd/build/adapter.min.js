function _typeof2(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof2=function(e){return typeof e}}else{_typeof2=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof2(e)}define ("core/adapter",[],function(){return function d(c,e,t){function r(i,o){if(!e[i]){if(!c[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=e[i]={exports:{}};c[i][0].call(p.exports,function(t){var e=c[i][1][t];return r(e?e:t)},p,p.exports,d,c,e,t)}return e[i].exports}for(var n="function"==typeof require&&require,a=0;a<t.length;a++){r(t[a])}return r}({1:[function(e,t){'use strict';var r=e("./adapter_factory.js"),n=(0,r.adapterFactory)({window:"undefined"==typeof window?void 0:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.adapterFactory=function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},t=e.window,r=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},n=a.log,o=a.detectBrowser(t),i={browserDetails:o,commonShim:y,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings,sdp:h};switch(o.browser){case"chrome":if(!s||!s.shimPeerConnection||!r.shimChrome){n("Chrome shim is not included in this adapter release.");return i}if(null===o.version){n("Chrome shim can not determine version, not shimming.");return i}n("adapter.js shimming chrome.");i.browserShim=s;y.shimAddIceCandidateNullOrEmpty(t,o);s.shimGetUserMedia(t,o);s.shimMediaStream(t,o);s.shimPeerConnection(t,o);s.shimOnTrack(t,o);s.shimAddTrackRemoveTrack(t,o);s.shimGetSendersWithDtmf(t,o);s.shimGetStats(t,o);s.shimSenderReceiverGetStats(t,o);s.fixNegotiationNeeded(t,o);y.shimRTCIceCandidate(t,o);y.shimConnectionState(t,o);y.shimMaxMessageSize(t,o);y.shimSendThrowTypeError(t,o);y.removeExtmapAllowMixed(t,o);break;case"firefox":if(!c||!c.shimPeerConnection||!r.shimFirefox){n("Firefox shim is not included in this adapter release.");return i}n("adapter.js shimming firefox.");i.browserShim=c;y.shimAddIceCandidateNullOrEmpty(t,o);c.shimGetUserMedia(t,o);c.shimPeerConnection(t,o);c.shimOnTrack(t,o);c.shimRemoveStream(t,o);c.shimSenderGetStats(t,o);c.shimReceiverGetStats(t,o);c.shimRTCDataChannel(t,o);c.shimAddTransceiver(t,o);c.shimGetParameters(t,o);c.shimCreateOffer(t,o);c.shimCreateAnswer(t,o);y.shimRTCIceCandidate(t,o);y.shimConnectionState(t,o);y.shimMaxMessageSize(t,o);y.shimSendThrowTypeError(t,o);break;case"safari":if(!m||!r.shimSafari){n("Safari shim is not included in this adapter release.");return i}n("adapter.js shimming safari.");i.browserShim=m;y.shimAddIceCandidateNullOrEmpty(t,o);m.shimRTCIceServerUrls(t,o);m.shimCreateOfferLegacy(t,o);m.shimCallbacksAPI(t,o);m.shimLocalStreamsAPI(t,o);m.shimRemoteStreamsAPI(t,o);m.shimTrackEventTransceiver(t,o);m.shimGetUserMedia(t,o);m.shimAudioContext(t,o);y.shimRTCIceCandidate(t,o);y.shimMaxMessageSize(t,o);y.shimSendThrowTypeError(t,o);y.removeExtmapAllowMixed(t,o);break;default:n("Unsupported browser!");break;}return i};var o=e("./utils"),a=n(o),i=e("./chrome/chrome_shim"),s=n(i),d=e("./firefox/firefox_shim"),c=n(d),p=e("./safari/safari_shim"),m=n(p),l=e("./common_shim"),y=n(l),C=e("sdp"),h=n(C);function n(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}},{"./chrome/chrome_shim":3,"./common_shim":6,"./firefox/firefox_shim":7,"./safari/safari_shim":10,"./utils":11,sdp:12}],3:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var d="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},c=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});var p=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return p.shimGetDisplayMedia}});r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream};r.shimOnTrack=o;r.shimGetSendersWithDtmf=a;r.shimGetStats=function(e){if(!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),n=r[0],o=r[1],a=r[2];if(0<arguments.length&&"function"==typeof n){return t.apply(this,arguments)}if(0===t.length&&(0===arguments.length||"function"!=typeof n)){return t.apply(this,[])}var i=function(e){var t={},r=e.result();r.forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)});t[r.id]=r});return t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(2<=arguments.length){var d=function(e){o(s(i(e)))};return t.apply(this,[d,n])}return new Promise(function(r,n){t.apply(e,[function(e){r(s(i(e)))},n])}).then(o,a)}};r.shimSenderReceiverGetStats=i;r.shimAddTrackRemoveTrackWithNative=s;r.shimAddTrackRemoveTrack=function(e,t){if(!e.RTCPeerConnection){return}if(e.RTCPeerConnection.prototype.addTrack&&65<=t.version){return s(e)}var a=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=a.apply(this);this._reverseStreams=this._reverseStreams||{};return t.map(function(t){return e._reverseStreams[t.id]})};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};t.getTracks().forEach(function(e){var t=r.getSenders().find(function(t){return t.track===e});if(t){throw new DOMException("Track already exists.","InvalidAccessError")}});if(!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n;this._reverseStreams[n.id]=t;t=n}i.apply(this,[t])};var d=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};d.apply(this,[this._streams[e.id]||e]);delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id];delete this._streams[e.id]};e.RTCPeerConnection.prototype.addTrack=function(r,n){var o=this;if("closed"===this.signalingState){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}var a=[].slice.call(arguments,1);if(1!==a.length||!a[0].getTracks().find(function(e){return e===r})){throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError")}var i=this.getSenders().find(function(e){return e.track===r});if(i){throw new DOMException("Track already exists.","InvalidAccessError")}this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};var s=this._streams[n.id];if(s){s.addTrack(r);Promise.resolve().then(function(){o.dispatchEvent(new Event("negotiationneeded"))})}else{var d=new e.MediaStream([r]);this._streams[n.id]=d;this._reverseStreams[d.id]=n;this.addStream(d)}return this.getSenders().find(function(e){return e.track===r})};function r(e,t){var r=t.sdp;Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],o=e._streams[n.id];r=r.replace(new RegExp(o.id,"g"),n.id)});return new RTCSessionDescription({type:t.type,sdp:r})}function o(e,t){var r=t.sdp;Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],o=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),o.id)});return new RTCSessionDescription({type:t.type,sdp:r})}["createOffer","createAnswer"].forEach(function(t){var o=e.RTCPeerConnection.prototype[t],a=n({},t,function(){var e=this,t=arguments,n=arguments.length&&"function"==typeof arguments[0];if(n){return o.apply(this,[function(n){var o=r(e,n);t[0].apply(null,[o])},function(e){if(t[1]){t[1].apply(null,e)}},arguments[2]])}return o.apply(this,arguments).then(function(t){return r(e,t)})});e.RTCPeerConnection.prototype[t]=a[t]});var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type){return c.apply(this,arguments)}arguments[0]=o(this,arguments[0]);return c.apply(this,arguments)};var p=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=p.get.apply(this);if(""===e.type){return e}return r(this,e)}});e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}if(!e._pc){throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError")}var r=e._pc===this;if(!r){throw new DOMException("Sender was not created by this connection.","InvalidAccessError")}this._streams=this._streams||{};var n;Object.keys(this._streams).forEach(function(r){var o=t._streams[r].getTracks().find(function(t){return e.track===t});if(o){n=t._streams[r]}});if(n){if(1===n.getTracks().length){this.removeStream(this._reverseStreams[n.id])}else{n.removeTrack(e.track)}this.dispatchEvent(new Event("negotiationneeded"))}}};r.shimPeerConnection=function(e,t){if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection){e.RTCPeerConnection=e.webkitRTCPeerConnection}if(!e.RTCPeerConnection){return}if(53>t.version){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],o=n({},t,function(){arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=o[t]})}};r.fixNegotiationNeeded=function(e,t){l.wrapPeerConnectionEvent(e,"negotiationneeded",function(r){var e=r.target;if(72>t.version||e.getConfiguration&&"plan-b"===e.getConfiguration().sdpSemantics){if("stable"!==e.signalingState){return}}return r})};var m=e("../utils.js"),l=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(m);function n(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=r}return e}function o(t){if("object"===("undefined"==typeof t?"undefined":d(t))&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){if(this._ontrack){this.removeEventListener("track",this._ontrack)}this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;if(!this._ontrackpoly){this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(e){var o;if(t.RTCPeerConnection.prototype.getReceivers){o=n.getReceivers().find(function(t){return t.track&&t.track.id===e.track.id})}else{o={track:e.track}}var a=new Event("track");a.track=e.track;a.receiver=o;a.transceiver={receiver:o};a.streams=[r.stream];n.dispatchEvent(a)});r.stream.getTracks().forEach(function(e){var o;if(t.RTCPeerConnection.prototype.getReceivers){o=n.getReceivers().find(function(t){return t.track&&t.track.id===e.id})}else{o={track:e}}var a=new Event("track");a.track=e;a.receiver=o;a.transceiver={receiver:o};a.streams=[r.stream];n.dispatchEvent(a)})};this.addEventListener("addstream",this._ontrackpoly)}return r.apply(this,arguments)}}else{l.wrapPeerConnectionEvent(t,"track",function(t){if(!t.transceiver){Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}})}return t})}}function a(e){if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){if(this._dtmf===void 0){if("audio"===t.kind){this._dtmf=e.createDTMFSender(t)}else{this._dtmf=null}}return this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e){var n=r.apply(this,arguments);if(!n){n=t(this,e);this._senders.push(n)}return n};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);if(-1!==t){this._senders.splice(t,1)}}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[];o.apply(this,[e]);e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[];a.apply(this,[e]);e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});if(r){t._senders.splice(t._senders.indexOf(r),1)}})}}else if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var i=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=i.apply(this,[]);t.forEach(function(t){return t._pc=e});return t};Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===void 0){if("audio"===this.track.kind){this._dtmf=this._pc.createDTMFSender(this.track)}else{this._dtmf=null}}return this._dtmf}})}}function i(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver)){return}if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;if(t){e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);r.forEach(function(t){return t._pc=e});return r}}var r=e.RTCPeerConnection.prototype.addTrack;if(r){e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return l.filterStats(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;if(n){e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);t.forEach(function(t){return t._pc=e});return t}}l.wrapPeerConnectionEvent(e,"track",function(t){t.receiver._pc=t.srcElement;return t});e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return l.filterStats(t,e.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype)){return}var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,a=void 0;this.getSenders().forEach(function(e){if(e.track===t){if(r){a=!0}else{r=e}}});this.getReceivers().forEach(function(e){if(e.track===t){if(n){a=!0}else{n=e}}return e.track===t});if(a||r&&n){return Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError"))}else if(r){return r.getStats()}else if(n){return n.getStats()}return Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}function s(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r){return t.apply(this,arguments)}this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);if(!this._shimmedLocalStreams[r.id]){this._shimmedLocalStreams[r.id]=[r,n]}else if(-1===this._shimmedLocalStreams[r.id].indexOf(n)){this._shimmedLocalStreams[r.id].push(n)}return n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});if(r){throw new DOMException("Track already exists.","InvalidAccessError")}});var n=this.getSenders();r.apply(this,arguments);var o=this.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(o)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[e.id];return n.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};if(e){Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);if(-1!==n){t._shimmedLocalStreams[r].splice(n,1)}if(1===t._shimmedLocalStreams[r].length){delete t._shimmedLocalStreams[r]}})}return o.apply(this,arguments)}}},{"../utils.js":11,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=n;function n(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices){return}if(!e.navigator.mediaDevices){return}if("function"!=typeof t){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(function(t){var n=r.video&&r.video.width,o=r.video&&r.video.height,a=r.video&&r.video.frameRate;r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}};if(n){r.video.mandatory.maxWidth=n}if(o){r.video.mandatory.maxHeight=o}return e.navigator.mediaDevices.getUserMedia(r)})}}},{}],5:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimGetUserMedia=function(e,t){var r=e&&e.navigator;if(!r.mediaDevices){return}var o=function(e){if("object"!==("undefined"==typeof e?"undefined":n(e))||e.mandatory||e.optional){return e}var t={};Object.keys(e).forEach(function(o){if("require"===o||"advanced"===o||"mediaSource"===o){return}var a="object"===n(e[o])?e[o]:{ideal:e[o]};if(a.exact!==void 0&&"number"==typeof a.exact){a.min=a.max=a.exact}var r=function(e,t){if(e){return e+t.charAt(0).toUpperCase()+t.slice(1)}return"deviceId"===t?"sourceId":t};if(a.ideal!==void 0){t.optional=t.optional||[];var i={};if("number"==typeof a.ideal){i[r("min",o)]=a.ideal;t.optional.push(i);i={};i[r("max",o)]=a.ideal;t.optional.push(i)}else{i[r("",o)]=a.ideal;t.optional.push(i)}}if(a.exact!==void 0&&"number"!=typeof a.exact){t.mandatory=t.mandatory||{};t.mandatory[r("",o)]=a.exact}else{["min","max"].forEach(function(e){if(a[e]!==void 0){t.mandatory=t.mandatory||{};t.mandatory[r(e,o)]=a[e]}})}});if(e.advanced){t.optional=(t.optional||[]).concat(e.advanced)}return t},a=function(e,a){if(61<=t.version){return a(e)}e=JSON.parse(JSON.stringify(e));if(e&&"object"===n(e.audio)){var s=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};e=JSON.parse(JSON.stringify(e));s(e.audio,"autoGainControl","googAutoGainControl");s(e.audio,"noiseSuppression","googNoiseSuppression");e.audio=o(e.audio)}if(e&&"object"===n(e.video)){var d=e.video.facingMode;d=d&&("object"===("undefined"==typeof d?"undefined":n(d))?d:{ideal:d});var c=66>t.version;if(d&&("user"===d.exact||"environment"===d.exact||"user"===d.ideal||"environment"===d.ideal)&&!(r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete e.video.facingMode;var p;if("environment"===d.exact||"environment"===d.ideal){p=["back","rear"]}else if("user"===d.exact||"user"===d.ideal){p=["front"]}if(p){return r.mediaDevices.enumerateDevices().then(function(t){t=t.filter(function(e){return"videoinput"===e.kind});var r=t.find(function(e){return p.some(function(t){return e.label.toLowerCase().includes(t)})});if(!r&&t.length&&p.includes("back")){r=t[t.length-1]}if(r){e.video.deviceId=d.exact?{exact:r.deviceId}:{ideal:r.deviceId}}e.video=o(e.video);i("chrome: "+JSON.stringify(e));return a(e)})}}e.video=o(e.video)}i("chrome: "+JSON.stringify(e));return a(e)},s=function(r){if(64<=t.version){return r}return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[r.name]||r.name,message:r.message,constraint:r.constraint||r.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};r.getUserMedia=function(e,t,n){a(e,function(e){r.webkitGetUserMedia(e,t,function(t){if(n){n(s(t))}})})}.bind(r);if(r.mediaDevices.getUserMedia){var d=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return a(e,function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length){t.getTracks().forEach(function(e){e.stop()});throw new DOMException("","NotFoundError")}return t},function(t){return Promise.reject(s(t))})})}}};var o=e("../utils.js"),a=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(o);var i=a.log},{"../utils.js":11}],6:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimRTCIceCandidate=n;r.shimMaxMessageSize=o;r.shimSendThrowTypeError=a;r.shimConnectionState=i;r.removeExtmapAllowMixed=function(e,t){if(!e.RTCPeerConnection){return}if("chrome"===t.browser&&71<=t.version){return}if("safari"===t.browser&&605<=t.version){return}var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var n=t.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n");if(e.RTCSessionDescription&&t instanceof e.RTCSessionDescription){arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n})}else{t.sdp=n}}return r.apply(this,arguments)}};r.shimAddIceCandidateNullOrEmpty=function(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype)){return}var r=e.RTCPeerConnection.prototype.addIceCandidate;if(!r||0===r.length){return}e.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}if(("chrome"===t.browser&&78>t.version||"firefox"===t.browser&&68>t.version||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate){return Promise.resolve()}return r.apply(this,arguments)}};var d=e("sdp"),c=function(e){return e&&e.__esModule?e:{default:e}}(d),p=e("./utils"),m=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(p);function n(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype){return}var r=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===("undefined"==typeof e?"undefined":s(e))&&e.candidate&&0===e.candidate.indexOf("a=")){e=JSON.parse(JSON.stringify(e));e.candidate=e.candidate.substr(2)}if(e.candidate&&e.candidate.length){var t=new r(e),n=c.default.parseCandidate(e.candidate),o=Object.assign(t,n);o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}};return o}return new r(e)};t.RTCIceCandidate.prototype=r.prototype;m.wrapPeerConnectionEvent(t,"icecandidate",function(r){if(r.candidate){Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"})}return r})}function o(e,t){if(!e.RTCPeerConnection){return}if(!("sctp"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp}})}var r=function(e){if(!e||!e.sdp){return!1}var t=c.default.splitSections(e.sdp);t.shift();return t.some(function(e){var t=c.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},n=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||2>t.length){return-1}var r=parseInt(t[1],10);return r!==r?-1:r},o=function(e){var r=65536;if("firefox"===t.browser){if(57>t.version){if(-1===e){r=16384}else{r=2147483637}}else if(60>t.version){r=57===t.version?65535:65536}else{r=2147483637}}return r},a=function(e,r){var n=65536;if("firefox"===t.browser&&57===t.version){n=65535}var o=c.default.matchPrefix(e.sdp,"a=max-message-size:");if(0<o.length){n=parseInt(o[0].substr(19),10)}else if("firefox"===t.browser&&-1!==r){n=2147483637}return n},i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;if("chrome"===t.browser&&76<=t.version){var e=this.getConfiguration(),s=e.sdpSemantics;if("plan-b"===s){Object.defineProperty(this,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}}if(r(arguments[0])){var d=n(arguments[0]),c=o(d),p=a(arguments[0],d),m=void 0;if(0===c&&0===p){m=Number.POSITIVE_INFINITY}else if(0===c||0===p){m=Math.max(c,p)}else{m=Math.min(c,p)}var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return m}});this._sctp=l}return i.apply(this,arguments)}}function a(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype)){return}function t(e,t){var r=e.send;e.send=function(){var n=arguments[0],o=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize){throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)")}return r.apply(e,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);t(e,this);return e};m.wrapPeerConnectionEvent(e,"datachannel",function(r){t(r.channel,r.target);return r})}function i(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype){return}var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){if(this._onconnectionstatechange){this.removeEventListener("connectionstatechange",this._onconnectionstatechange);delete this._onconnectionstatechange}if(e){this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)}},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(e){var r=t[e];t[e]=function(){if(!this._connectionstatechangepoly){this._connectionstatechangepoly=function(t){var e=t.target;if(e._lastConnectionState!==e.connectionState){e._lastConnectionState=e.connectionState;var r=new Event("connectionstatechange",t);e.dispatchEvent(r)}return t};this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)}return r.apply(this,arguments)}})}},{"./utils":11,sdp:12}],7:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var d="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},c=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});var p=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return p.shimGetDisplayMedia}});r.shimOnTrack=o;r.shimPeerConnection=function(e,t){if("object"!==("undefined"==typeof e?"undefined":d(e))||!(e.RTCPeerConnection||e.mozRTCPeerConnection)){return}if(!e.RTCPeerConnection&&e.mozRTCPeerConnection){e.RTCPeerConnection=e.mozRTCPeerConnection}if(53>t.version){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],o=n({},t,function(){arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=o[t]})}var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[0],a=e[1],i=e[2];return o.apply(this,[n||null]).then(function(n){if(53>t.version&&!a){try{n.forEach(function(e){e.type=r[e.type]||e.type})}catch(t){if("TypeError"!==t.name){throw t}n.forEach(function(e,t){n.set(t,Object.assign({},e,{type:r[e.type]||e.type}))})}}return n}).then(a,i)}};r.shimSenderGetStats=a;r.shimReceiverGetStats=i;r.shimRemoveStream=s;r.shimRTCDataChannel=function(e){if(e.DataChannel&&!e.RTCDataChannel){e.RTCDataChannel=e.DataChannel}};r.shimAddTransceiver=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection)){return}var t=e.RTCPeerConnection.prototype.addTransceiver;if(t){e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;if(r){e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid)){throw new TypeError("Invalid RID value provided.")}}if("scaleResolutionDownBy"in e){if(!(1<=parseFloat(e.scaleResolutionDownBy))){throw new RangeError("scale_resolution_down_by must be >= 1.0")}}if("maxFramerate"in e){if(!(0<=parseFloat(e.maxFramerate))){throw new RangeError("max_framerate must be >= 0.0")}}})}var n=t.apply(this,arguments);if(r){var o=n.sender,a=o.getParameters();if(!("encodings"in a)||1===a.encodings.length&&0===Object.keys(a.encodings[0]).length){a.encodings=e.sendEncodings;o.sendEncodings=e.sendEncodings;this.setParametersPromises.push(o.setParameters(a).then(function(){delete o.sendEncodings}).catch(function(){delete o.sendEncodings}))}}return n}}};r.shimGetParameters=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCRtpSender)){return}var t=e.RTCRtpSender.prototype.getParameters;if(t){e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);if(!("encodings"in e)){e.encodings=[].concat(this.sendEncodings||[{}])}return e}}};r.shimCreateOffer=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection)){return}var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,r=arguments;if(this.setParametersPromises&&this.setParametersPromises.length){return Promise.all(this.setParametersPromises).then(function(){return t.apply(e,r)}).finally(function(){e.setParametersPromises=[]})}return t.apply(this,arguments)}};r.shimCreateAnswer=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection)){return}var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,r=arguments;if(this.setParametersPromises&&this.setParametersPromises.length){return Promise.all(this.setParametersPromises).then(function(){return t.apply(e,r)}).finally(function(){e.setParametersPromises=[]})}return t.apply(this,arguments)}};var m=e("../utils"),l=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(m);function n(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=r}return e}function o(e){if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}}function a(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype){return}var t=e.RTCPeerConnection.prototype.getSenders;if(t){e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);r.forEach(function(t){return t._pc=e});return r}}var r=e.RTCPeerConnection.prototype.addTrack;if(r){e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function i(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype){return}var t=e.RTCPeerConnection.prototype.getReceivers;if(t){e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);r.forEach(function(t){return t._pc=e});return r}}l.wrapPeerConnectionEvent(e,"track",function(t){t.receiver._pc=t.srcElement;return t});e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function s(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype){return}e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;l.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(r){if(r.track&&e.getTracks().includes(r.track)){t.removeTrack(r)}})}}},{"../utils":11,"./getdisplaymedia":8,"./getusermedia":9}],8:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=n;function n(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices){return}if(!e.navigator.mediaDevices){return}e.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){var n=new DOMException("getDisplayMedia without video constraints is undefined");n.name="NotFoundError";n.code=8;return Promise.reject(n)}if(!0===r.video){r.video={mediaSource:t}}else{r.video.mediaSource=t}return e.navigator.mediaDevices.getUserMedia(r)}}},{}],9:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimGetUserMedia=n;var a=e("../utils"),i=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(a);function n(e,t){var r=e&&e.navigator,n=e&&e.MediaStreamTrack;r.getUserMedia=function(e,t,n){i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");r.mediaDevices.getUserMedia(e).then(t,n)};if(!(55<t.version&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var a=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}},s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){if("object"===("undefined"==typeof e?"undefined":o(e))&&"object"===o(e.audio)){e=JSON.parse(JSON.stringify(e));a(e.audio,"autoGainControl","mozAutoGainControl");a(e.audio,"noiseSuppression","mozNoiseSuppression")}return s(e)};if(n&&n.prototype.getSettings){var d=n.prototype.getSettings;n.prototype.getSettings=function(){var e=d.apply(this,arguments);a(e,"mozAutoGainControl","autoGainControl");a(e,"mozNoiseSuppression","noiseSuppression");return e}}if(n&&n.prototype.applyConstraints){var p=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){if("audio"===this.kind&&"object"===("undefined"==typeof e?"undefined":o(e))){e=JSON.parse(JSON.stringify(e));a(e,"autoGainControl","mozAutoGainControl");a(e,"noiseSuppression","mozNoiseSuppression")}return p.apply(this,[e])}}}}},{"../utils":11}],10:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimLocalStreamsAPI=n;r.shimRemoteStreamsAPI=o;r.shimCallbacksAPI=function(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,i=t.addIceCandidate;t.createOffer=function(e,t){var n=2<=arguments.length?arguments[2]:arguments[0],o=r.apply(this,[n]);if(!t){return o}o.then(e,t);return Promise.resolve()};t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:arguments[0],o=n.apply(this,[r]);if(!t){return o}o.then(e,t);return Promise.resolve()};var s=function(e,t,r){var n=o.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.setLocalDescription=s;s=function(e,t,r){var n=a.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.setRemoteDescription=s;s=function(e,t,r){var n=i.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.addIceCandidate=s};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(a(e))}}if(!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia){t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t)}};r.shimConstraints=a;r.shimRTCIceServerUrls=i;r.shimTrackEventTransceiver=s;r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){if("undefined"!=typeof e.offerToReceiveAudio){e.offerToReceiveAudio=!!e.offerToReceiveAudio}var r=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});if(!1===e.offerToReceiveAudio&&r){if("sendrecv"===r.direction){if(r.setDirection){r.setDirection("sendonly")}else{r.direction="sendonly"}}else if("recvonly"===r.direction){if(r.setDirection){r.setDirection("inactive")}else{r.direction="inactive"}}}else if(!0===e.offerToReceiveAudio&&!r){this.addTransceiver("audio")}if("undefined"!=typeof e.offerToReceiveVideo){e.offerToReceiveVideo=!!e.offerToReceiveVideo}var n=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});if(!1===e.offerToReceiveVideo&&n){if("sendrecv"===n.direction){if(n.setDirection){n.setDirection("sendonly")}else{n.direction="sendonly"}}else if("recvonly"===n.direction){if(n.setDirection){n.setDirection("inactive")}else{n.direction="inactive"}}}else if(!0===e.offerToReceiveVideo&&!n){this.addTransceiver("video")}}return t.apply(this,arguments)}};r.shimAudioContext=function(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||e.AudioContext){return}e.AudioContext=e.webkitAudioContext};var c=e("../utils"),p=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(c);function n(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||!e.RTCPeerConnection){return}if(!("getLocalStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getLocalStreams=function(){if(!this._localStreams){this._localStreams=[]}return this._localStreams}}if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(!this._localStreams){this._localStreams=[]}if(!this._localStreams.includes(e)){this._localStreams.push(e)}e.getAudioTracks().forEach(function(n){return t.call(r,n,e)});e.getVideoTracks().forEach(function(n){return t.call(r,n,e)})};e.RTCPeerConnection.prototype.addTrack=function(){for(var e=this,r=arguments.length,n=Array(1<r?r-1:0),o=1;o<r;o++){n[o-1]=arguments[o]}if(n){n.forEach(function(t){if(!e._localStreams){e._localStreams=[t]}else if(!e._localStreams.includes(t)){e._localStreams.push(t)}})}return t.apply(this,arguments)}}if(!("removeStream"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;if(!this._localStreams){this._localStreams=[]}var r=this._localStreams.indexOf(e);if(-1===r){return}this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach(function(e){if(n.includes(e.track)){t.removeTrack(e)}})}}}function o(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||!e.RTCPeerConnection){return}if(!("getRemoteStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}}if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;if(this._onaddstream){this.removeEventListener("addstream",this._onaddstream);this.removeEventListener("track",this._onaddstreampoly)}this.addEventListener("addstream",this._onaddstream=e);this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(function(e){if(!t._remoteStreams){t._remoteStreams=[]}if(t._remoteStreams.includes(e)){return}t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e;t.dispatchEvent(r)})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;if(!this._onaddstreampoly){this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(!e._remoteStreams){e._remoteStreams=[]}if(0<=e._remoteStreams.indexOf(t)){return}e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t;e.dispatchEvent(r)})})}return t.apply(e,arguments)}}}function a(e){if(e&&e.video!==void 0){return Object.assign({},e,{video:p.compactObject(e.video)})}return e}function i(e){if(!e.RTCPeerConnection){return}var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],o=0,a;o<e.iceServers.length;o++){a=e.iceServers[o];if(!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")){p.deprecated("RTCIceServer.url","RTCIceServer.urls");a=JSON.parse(JSON.stringify(a));a.urls=a.url;delete a.url;n.push(a)}else{n.push(e.iceServers[o])}}e.iceServers=n}return new t(e,r)};e.RTCPeerConnection.prototype=t.prototype;if("generateCertificate"in t){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function s(e){if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}}},{"../utils":11}],11:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var m="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.extractVersion=o;r.wrapPeerConnectionEvent=function(e,t,r){if(!e.RTCPeerConnection){return}var n=e.RTCPeerConnection.prototype,o=n.addEventListener;n.addEventListener=function(e,n){if(e!==t){return o.apply(this,arguments)}var a=function(t){var e=r(t);if(e){if(n.handleEvent){n.handleEvent(e)}else{n(e)}}};this._eventMap=this._eventMap||{};if(!this._eventMap[t]){this._eventMap[t]=new Map}this._eventMap[t].set(n,a);return o.apply(this,[e,a])};var a=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t]){return a.apply(this,arguments)}if(!this._eventMap[t].has(r)){return a.apply(this,arguments)}var n=this._eventMap[t].get(r);this._eventMap[t].delete(r);if(0===this._eventMap[t].size){delete this._eventMap[t]}if(0===Object.keys(this._eventMap).length){delete this._eventMap}return a.apply(this,[e,n])};Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){if(this["_on"+t]){this.removeEventListener(t,this["_on"+t]);delete this["_on"+t]}if(e){this.addEventListener(t,this["_on"+t]=e)}},enumerable:!0,configurable:!0})};r.disableLog=function(e){if("boolean"!=typeof e){return new Error("Argument type: "+("undefined"==typeof e?"undefined":m(e))+". Please use a boolean.")}l=e;return e?"adapter.js logging disabled":"adapter.js logging enabled"};r.disableWarnings=function(e){if("boolean"!=typeof e){return new Error("Argument type: "+("undefined"==typeof e?"undefined":m(e))+". Please use a boolean.")}y=!e;return"adapter.js deprecation warnings "+(e?"disabled":"enabled")};r.log=a;r.deprecated=i;r.detectBrowser=s;r.compactObject=c;r.walkStats=p;r.filterStats=function(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t){return o}var a=[];e.forEach(function(e){if("track"===e.type&&e.trackIdentifier===t.id){a.push(e)}});a.forEach(function(t){e.forEach(function(r){if(r.type===n&&r.trackId===t.id){p(e,r,o)}})});return o};function n(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=r}return e}var l=!0,y=!0;function o(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function a(){if("object"===("undefined"==typeof window?"undefined":m(window))){if(l){return}if("undefined"!=typeof console&&"function"==typeof console.log){console.log.apply(console,arguments)}}}function i(e,t){if(!y){return}console.warn(e+" is deprecated, please use "+t+" instead.")}function s(e){var t={browser:null,version:null};if("undefined"==typeof e||!e.navigator){t.browser="Not a browser.";return t}var r=e.navigator;if(r.mozGetUserMedia){t.browser="firefox";t.version=o(r.userAgent,/Firefox\/(\d+)\./,1)}else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer){t.browser="chrome";t.version=o(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2)}else if(e.RTCPeerConnection&&r.userAgent.match(/AppleWebKit\/(\d+)\./)){t.browser="safari";t.version=o(r.userAgent,/AppleWebKit\/(\d+)\./,1);t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}else{t.browser="Not a supported browser.";return t}return t}function d(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e){if(!d(e)){return e}return Object.keys(e).reduce(function(t,r){var o=d(e[r]),a=o?c(e[r]):e[r],i=o&&!Object.keys(a).length;if(a===void 0||i){return t}return Object.assign(t,n({},r,a))},{})}function p(e,t,r){if(!t||r.has(t.id)){return}r.set(t.id,t);Object.keys(t).forEach(function(n){if(n.endsWith("Id")){p(e,e.get(t[n]),r)}else if(n.endsWith("Ids")){t[n].forEach(function(t){p(e,e.get(t),r)})}})}},{}],12:[function(e,t){'use strict';var r="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},n={};n.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)};n.localCName=n.generateIdentifier();n.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})};n.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})};n.getDescription=function(e){var t=n.splitSections(e);return t&&t[0]};n.getMediaSections=function(e){var t=n.splitSections(e);t.shift();return t};n.matchPrefix=function(e,t){return n.splitLines(e).filter(function(e){return 0===e.indexOf(t)})};n.parseCandidate=function(e){var t;if(0===e.indexOf("a=candidate:")){t=e.substring(12).split(" ")}else{t=e.substring(10).split(" ")}for(var r={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2){switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1];r.usernameFragment=t[n+1];break;default:if(r[t[n]]===void 0){r[t[n]]=t[n+1]}break;}}return r};n.writeCandidate=function(e){var t=[e.foundation],r=e.component;if("rtp"===r){t.push(1)}else if("rtcp"===r){t.push(2)}else{t.push(r)}t.push(e.protocol.toUpperCase());t.push(e.priority);t.push(e.address||e.ip);t.push(e.port);var n=e.type;t.push("typ");t.push(n);if("host"!==n&&e.relatedAddress&&e.relatedPort){t.push("raddr");t.push(e.relatedAddress);t.push("rport");t.push(e.relatedPort)}if(e.tcpType&&"tcp"===e.protocol.toLowerCase()){t.push("tcptype");t.push(e.tcpType)}if(e.usernameFragment||e.ufrag){t.push("ufrag");t.push(e.usernameFragment||e.ufrag)}return"candidate:"+t.join(" ")};n.parseIceOptions=function(e){return e.substr(14).split(" ")};n.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};t=t[0].split("/");r.name=t[0];r.clockRate=parseInt(t[1],10);r.channels=3===t.length?parseInt(t[2],10):1;r.numChannels=r.channels;return r};n.writeRtpMap=function(e){var t=e.payloadType;if(e.preferredPayloadType!==void 0){t=e.preferredPayloadType}var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"};n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}};n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"};n.parseFmtp=function(e){for(var t={},r=void 0,n=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<n.length;o++){r=n[o].trim().split("=");t[r[0].trim()]=r[1]}return t};n.writeFmtp=function(e){var t="",r=e.payloadType;if(e.preferredPayloadType!==void 0){r=e.preferredPayloadType}if(e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach(function(t){if(e.parameters[t]){n.push(t+"="+e.parameters[t])}else{n.push(t)}});t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t};n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}};n.writeRtcpFb=function(e){var t="",r=e.payloadType;if(e.preferredPayloadType!==void 0){r=e.preferredPayloadType}if(e.rtcpFeedback&&e.rtcpFeedback.length){e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})}return t};n.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);if(-1<n){r.attribute=e.substr(t+1,n-t-1);r.value=e.substr(n+1)}else{r.attribute=e.substr(t+1)}return r};n.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}};n.getMid=function(e){var t=n.matchPrefix(e,"a=mid:")[0];if(t){return t.substr(6)}};n.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}};n.getDtlsParameters=function(e,t){var r=n.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:r.map(n.parseFingerprint)}};n.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"});return r};n.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}};n.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===r(e.keyParams)?n.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"};n.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:")){return null}var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}};n.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")};n.getCryptoParameters=function(e,t){var r=n.matchPrefix(e+t,"a=crypto:");return r.map(n.parseCryptoLine)};n.getIceParameters=function(e,t){var r=n.matchPrefix(e+t,"a=ice-ufrag:")[0],o=n.matchPrefix(e+t,"a=ice-pwd:")[0];if(!(r&&o)){return null}return{usernameFragment:r.substr(12),password:o.substr(10)}};n.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";if(e.iceLite){t+="a=ice-lite\r\n"}return t};n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e),o=r[0].split(" "),a=3;a<o.length;a++){var s=o[a],d=n.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(d){var c=n.parseRtpMap(d),p=n.matchPrefix(e,"a=fmtp:"+s+" ");c.parameters=p.length?n.parseFmtp(p[0]):{};c.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(n.parseRtcpFb);t.codecs.push(c);switch(c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase());break;default:break;}}}n.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(n.parseExtmap(e))});return t};n.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ";r+=0<t.codecs.length?"9":"0";r+=" UDP/TLS/RTP/SAVPF ";r+=t.codecs.map(function(e){if(e.preferredPayloadType!==void 0){return e.preferredPayloadType}return e.payloadType}).join(" ")+"\r\n";r+="c=IN IP4 0.0.0.0\r\n";r+="a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){r+=n.writeRtpMap(e);r+=n.writeFmtp(e);r+=n.writeRtcpFb(e)});var o=0;t.codecs.forEach(function(e){if(e.maxptime>o){o=e.maxptime}});if(0<o){r+="a=maxptime:"+o+"\r\n"}if(t.headerExtensions){t.headerExtensions.forEach(function(e){r+=n.writeExtmap(e)})}return r};n.parseRtpEncodingParameters=function(e){var t=[],r=n.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),a=-1!==r.fecMechanisms.indexOf("ULPFEC"),i=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<i.length&&i[0].ssrc,d=void 0,c=n.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.substr(17).split(" ");return t.map(function(e){return parseInt(e,10)})});if(0<c.length&&1<c[0].length&&c[0][0]===s){d=c[0][1]}r.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};if(s&&d){r.rtx={ssrc:d}}t.push(r);if(o){r=JSON.parse(JSON.stringify(r));r.fec={ssrc:s,mechanism:a?"red+ulpfec":"red"};t.push(r)}}});if(0===t.length&&s){t.push({ssrc:s})}var p=n.matchPrefix(e,"b=");if(p.length){if(0===p[0].indexOf("b=TIAS:")){p=parseInt(p[0].substr(7),10)}else if(0===p[0].indexOf("b=AS:")){p=.95*(1e3*parseInt(p[0].substr(5),10))-16000}else{p=void 0}t.forEach(function(e){e.maxBitrate=p})}return t};n.parseRtcpParameters=function(e){var t={},r=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];if(r){t.cname=r.value;t.ssrc=r.ssrc}var o=n.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<o.length;t.compound=0===o.length;var a=n.matchPrefix(e,"a=rtcp-mux");t.mux=0<a.length;return t};n.writeRtcpParameters=function(e){var t="";if(e.reducedSize){t+="a=rtcp-rsize\r\n"}if(e.mux){t+="a=rtcp-mux\r\n"}if(e.ssrc!==void 0&&e.cname){t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"}return t};n.parseMsid=function(e){var t=void 0,r=n.matchPrefix(e,"a=msid:");if(1===r.length){t=r[0].substr(7).split(" ");return{stream:t[0],track:t[1]}}var o=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});if(0<o.length){t=o[0].value.split(" ");return{stream:t[0],track:t[1]}}};n.parseSctpDescription=function(e){var t=n.parseMLine(e),r=n.matchPrefix(e,"a=max-message-size:"),o=void 0;if(0<r.length){o=parseInt(r[0].substr(19),10)}if(isNaN(o)){o=65536}var a=n.matchPrefix(e,"a=sctp-port:");if(0<a.length){return{port:parseInt(a[0].substr(12),10),protocol:t.fmt,maxMessageSize:o}}var i=n.matchPrefix(e,"a=sctpmap:");if(0<i.length){var s=i[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:o}}};n.writeSctpDescription=function(e,t){var r=[];if("DTLS/SCTP"!==e.protocol){r=["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]}else{r=["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"]}if(t.maxMessageSize!==void 0){r.push("a=max-message-size:"+t.maxMessageSize+"\r\n")}return r.join("")};n.generateSessionId=function(){return Math.random().toString().substr(2,21)};n.writeSessionBoilerplate=function(e,t,r){var o=void 0,a=t!==void 0?t:2;if(e){o=e}else{o=n.generateSessionId()}return"v=0\r\no="+(r||"thisisadapterortc")+" "+o+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};n.getDirection=function(e,t){for(var r=n.splitLines(e),o=0;o<r.length;o++){switch(r[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[o].substr(2);default:}}if(t){return n.getDirection(t)}return"sendrecv"};n.getKind=function(e){var t=n.splitLines(e),r=t[0].split(" ");return r[0].substr(2)};n.isRejected=function(e){return"0"===e.split(" ",2)[1]};n.parseMLine=function(e){var t=n.splitLines(e),r=t[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}};n.parseOLine=function(e){var t=n.matchPrefix(e,"o=")[0],r=t.substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}};n.isValidSDP=function(e){if("string"!=typeof e||0===e.length){return!1}for(var t=n.splitLines(e),r=0;r<t.length;r++){if(2>t[r].length||"="!==t[r].charAt(1)){return!1}}return!0};if("object"===("undefined"==typeof t?"undefined":r(t))){t.exports=n}},{}]},{},[1])(1)});
//# sourceMappingURL=adapter.min.js.map
